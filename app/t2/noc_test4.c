#include <hellfire.h>
#include <noc.h>

char p[50][9][9] = {
		{
	  {0,0,3,0,2,0,6,0,0},
	  {9,0,0,3,0,5,0,0,1},
	  {0,0,1,8,0,6,4,0,0},
	  {0,0,8,1,0,2,9,0,0},
	  {7,0,0,0,0,0,0,0,8},
	  {0,0,6,7,0,8,2,0,0},
	  {0,0,2,6,0,9,5,0,0},
	  {8,0,0,2,0,3,0,0,9},
	  {0,0,5,0,1,0,3,0,0}
	},{
	  {2,0,0,0,8,0,3,0,0},
	  {0,6,0,0,7,0,0,8,4},
	  {0,3,0,5,0,0,2,0,9},
	  {0,0,0,1,0,5,4,0,8},
	  {0,0,0,0,0,0,0,0,0},
	  {4,0,2,7,0,6,0,0,0},
	  {3,0,1,0,0,7,0,4,0},
	  {7,2,0,0,4,0,0,6,0},
	  {0,0,4,0,1,0,0,0,3}
	},{
	  {0,0,0,0,0,0,9,0,7},
	  {0,0,0,4,2,0,1,8,0},
	  {0,0,0,7,0,5,0,2,6},
	  {1,0,0,9,0,4,0,0,0},
	  {0,5,0,0,0,0,0,4,0},
	  {0,0,0,5,0,7,0,0,9},
	  {9,2,0,1,0,8,0,0,0},
	  {0,3,4,0,5,9,0,0,0},
	  {5,0,7,0,0,0,0,0,0}
	},{
	  {0,3,0,0,5,0,0,4,0},
	  {0,0,8,0,1,0,5,0,0},
	  {4,6,0,0,0,0,0,1,2},
	  {0,7,0,5,0,2,0,8,0},
	  {0,0,0,6,0,3,0,0,0},
	  {0,4,0,1,0,9,0,3,0},
	  {2,5,0,0,0,0,0,9,8},
	  {0,0,1,0,2,0,6,0,0},
	  {0,8,0,0,6,0,0,2,0}
	},{
	  {0,2,0,8,1,0,7,4,0},
	  {7,0,0,0,0,3,1,0,0},
	  {0,9,0,0,0,2,8,0,5},
	  {0,0,9,0,4,0,0,8,7},
	  {4,0,0,2,0,8,0,0,3},
	  {1,6,0,0,3,0,2,0,0},
	  {3,0,2,7,0,0,0,6,0},
	  {0,0,5,6,0,0,0,0,8},
	  {0,7,6,0,5,1,0,9,0}
	},{
	  {1,0,0,9,2,0,0,0,0},
	  {5,2,4,0,1,0,0,0,0},
	  {0,0,0,0,0,0,0,7,0},
	  {0,5,0,0,0,8,1,0,2},
	  {0,0,0,0,0,0,0,0,0},
	  {4,0,2,7,0,0,0,9,0},
	  {0,6,0,0,0,0,0,0,0},
	  {0,0,0,0,3,0,9,4,5},
	  {0,0,0,0,7,1,0,0,6}
	},{
	  {0,4,3,0,8,0,2,5,0},
	  {6,0,0,0,0,0,0,0,0},
	  {0,0,0,0,0,1,0,9,4},
	  {9,0,0,0,0,4,0,7,0},
	  {0,0,0,6,0,8,0,0,0},
	  {0,1,0,2,0,0,0,0,3},
	  {8,2,0,5,0,0,0,0,0},
	  {0,0,0,0,0,0,0,0,5},
	  {0,3,4,0,9,0,7,1,0}
	},{
	  {4,8,0,0,0,6,9,0,2},
	  {0,0,2,0,0,8,0,0,1},
	  {9,0,0,3,7,0,0,6,0},
	  {8,4,0,0,1,0,2,0,0},
	  {0,0,3,7,0,4,1,0,0},
	  {0,0,1,0,6,0,0,4,9},
	  {0,2,0,0,8,5,0,0,7},
	  {7,0,0,9,0,0,6,0,0},
	  {6,0,9,2,0,0,0,1,8}
	},{
	  {0,0,0,9,0,0,0,0,2},
	  {0,5,0,1,2,3,4,0,0},
	  {0,3,0,0,0,0,1,6,0},
	  {9,0,8,0,0,0,0,0,0},
	  {0,7,0,0,0,0,0,9,0},
	  {0,0,0,0,0,0,2,0,5},
	  {0,9,1,0,0,0,0,5,0},
	  {0,0,7,4,3,9,0,2,0},
	  {4,0,0,0,0,7,0,0,0}
	},{
	  {0,0,1,9,0,0,0,0,3},
	  {9,0,0,7,0,0,1,6,0},
	  {0,3,0,0,0,5,0,0,7},
	  {0,5,0,0,0,0,0,0,9},
	  {0,0,4,3,0,2,6,0,0},
	  {2,0,0,0,0,0,0,7,0},
	  {6,0,0,1,0,0,0,3,0},
	  {0,4,2,0,0,7,0,0,6},
	  {5,0,0,0,0,6,8,0,0}
	},{
	  {0,0,0,1,2,5,4,0,0},
	  {0,0,8,4,0,0,0,0,0},
	  {4,2,0,8,0,0,0,0,0},
	  {0,3,0,0,0,0,0,9,5},
	  {0,6,0,9,0,2,0,1,0},
	  {5,1,0,0,0,0,0,6,0},
	  {0,0,0,0,0,3,0,4,9},
	  {0,0,0,0,0,7,2,0,0},
	  {0,0,1,2,9,8,0,0,0}
	},{
	  {0,6,2,3,4,0,7,5,0},
	  {1,0,0,0,0,5,6,0,0},
	  {5,7,0,0,0,0,0,4,0},
	  {0,0,0,0,9,4,8,0,0},
	  {4,0,0,0,0,0,0,0,6},
	  {0,0,5,8,3,0,0,0,0},
	  {0,3,0,0,0,0,0,9,1},
	  {0,0,6,4,0,0,0,0,7},
	  {0,5,9,0,8,3,2,6,0}
	},{
	  {3,0,0,0,0,0,0,0,0},
	  {0,0,5,0,0,9,0,0,0},
	  {2,0,0,5,0,4,0,0,0},
	  {0,2,0,0,0,0,7,0,0},
	  {1,6,0,0,0,0,0,5,8},
	  {7,0,4,3,1,0,6,0,0},
	  {0,0,0,8,9,0,1,0,0},
	  {0,0,0,0,6,7,0,8,0},
	  {0,0,0,0,0,5,4,3,7}
	},{
	  {6,3,0,0,0,0,0,0,0},
	  {0,0,0,5,0,0,0,0,8},
	  {0,0,5,6,7,4,0,0,0},
	  {0,0,0,0,2,0,0,0,0},
	  {0,0,3,4,0,1,0,2,0},
	  {0,0,0,0,0,0,3,4,5},
	  {0,0,0,0,0,7,0,0,4},
	  {0,8,0,3,0,0,9,0,2},
	  {9,4,7,1,0,0,0,8,0}
	},{
	  {0,0,0,0,2,0,0,4,0},
	  {0,0,8,0,3,5,0,0,0},
	  {0,0,0,0,7,0,6,0,2},
	  {0,3,1,0,4,6,9,7,0},
	  {2,0,0,0,0,0,0,0,0},
	  {0,0,0,5,0,1,2,0,3},
	  {0,4,9,0,0,0,7,3,0},
	  {0,0,0,0,0,0,0,1,0},
	  {8,0,0,0,0,4,0,0,0}
	},{
	  {3,6,1,0,2,5,9,0,0},
	  {0,8,0,9,6,0,0,1,0},
	  {4,0,0,0,0,0,0,5,7},
	  {0,0,8,0,0,0,4,7,1},
	  {0,0,0,6,0,3,0,0,0},
	  {2,5,9,0,0,0,8,0,0},
	  {7,4,0,0,0,0,0,0,5},
	  {0,2,0,0,1,8,0,6,0},
	  {0,0,5,4,7,0,3,2,9}
	},{
	  {0,5,0,8,0,7,0,2,0},
	  {6,0,0,0,1,0,0,9,0},
	  {7,0,2,5,4,0,0,0,6},
	  {0,7,0,0,2,0,3,0,1},
	  {5,0,4,0,0,0,9,0,8},
	  {1,0,3,0,8,0,0,7,0},
	  {9,0,0,0,7,6,2,0,5},
	  {0,6,0,0,9,0,0,0,3},
	  {0,8,0,1,0,3,0,4,0}
	},{
	  {0,8,0,0,0,5,0,0,0},
	  {0,0,0,0,0,3,4,5,7},
	  {0,0,0,0,7,0,8,0,9},
	  {0,6,0,4,0,0,9,0,3},
	  {0,0,7,0,1,0,5,0,0},
	  {4,0,8,0,0,7,0,2,0},
	  {9,0,1,0,2,0,0,0,0},
	  {8,4,2,3,0,0,0,0,0},
	  {0,0,0,1,0,0,0,8,0}
	},{
	  {0,0,3,5,0,2,9,0,0},
	  {0,0,0,0,4,0,0,0,0},
	  {1,0,6,0,0,0,3,0,5},
	  {9,0,0,2,5,1,0,0,8},
	  {0,7,0,4,0,8,0,3,0},
	  {8,0,0,7,6,3,0,0,1},
	  {3,0,8,0,0,0,1,0,4},
	  {0,0,0,0,2,0,0,0,0},
	  {0,0,5,1,0,4,8,0,0}
	},{
	  {0,0,0,0,0,0,0,0,0},
	  {0,0,9,8,0,5,1,0,0},
	  {0,5,1,9,0,7,4,2,0},
	  {2,9,0,4,0,1,0,6,5},
	  {0,0,0,0,0,0,0,0,0},
	  {1,4,0,5,0,8,0,9,3},
	  {0,2,6,7,0,9,5,8,0},
	  {0,0,5,1,0,3,6,0,0},
	  {0,0,0,0,0,0,0,0,0}
	},{
	  {0,2,0,0,3,0,0,9,0},
	  {0,0,0,9,0,7,0,0,0},
	  {9,0,0,2,0,8,0,0,5},
	  {0,0,4,8,0,6,5,0,0},
	  {6,0,7,0,0,0,2,0,8},
	  {0,0,3,1,0,2,9,0,0},
	  {8,0,0,6,0,5,0,0,7},
	  {0,0,0,3,0,9,0,0,0},
	  {0,3,0,0,2,0,0,5,0}
	},{
	  {0,0,5,0,0,0,0,0,6},
	  {0,7,0,0,0,9,0,2,0},
	  {0,0,0,5,0,0,1,0,7},
	  {8,0,4,1,5,0,0,0,0},
	  {0,0,0,8,0,3,0,0,0},
	  {0,0,0,0,9,2,8,0,5},
	  {9,0,7,0,0,6,0,0,0},
	  {0,3,0,4,0,0,0,1,0},
	  {2,0,0,0,0,0,6,0,0}
	},{
	  {0,4,0,0,0,0,0,5,0},
	  {0,0,1,9,4,3,6,0,0},
	  {0,0,9,0,0,0,3,0,0},
	  {6,0,0,0,5,0,0,0,2},
	  {1,0,3,0,0,0,5,0,6},
	  {8,0,0,0,2,0,0,0,7},
	  {0,0,5,0,0,0,2,0,0},
	  {0,0,2,4,3,6,7,0,0},
	  {0,3,0,0,0,0,0,4,0}
	},{
	  {0,0,4,0,0,0,0,0,0},
	  {0,0,0,0,3,0,0,0,2},
	  {3,9,0,7,0,0,0,8,0},
	  {4,0,0,0,0,9,0,0,1},
	  {2,0,9,8,0,1,3,0,7},
	  {6,0,0,2,0,0,0,0,8},
	  {0,1,0,0,0,8,0,5,3},
	  {9,0,0,0,4,0,0,0,0},
	  {0,0,0,0,0,0,8,0,0}
	},{
	  {3,6,0,0,2,0,0,8,9},
	  {0,0,0,3,6,1,0,0,0},
	  {0,0,0,0,0,0,0,0,0},
	  {8,0,3,0,0,0,6,0,2},
	  {4,0,0,6,0,3,0,0,7},
	  {6,0,7,0,0,0,1,0,8},
	  {0,0,0,0,0,0,0,0,0},
	  {0,0,0,4,1,8,0,0,0},
	  {9,7,0,0,3,0,0,1,4}
	},{
	  {5,0,0,4,0,0,0,6,0},
	  {0,0,9,0,0,0,8,0,0},
	  {6,4,0,0,2,0,0,0,0},
	  {0,0,0,0,0,1,0,0,8},
	  {2,0,8,0,0,0,5,0,1},
	  {7,0,0,5,0,0,0,0,0},
	  {0,0,0,0,9,0,0,8,4},
	  {0,0,3,0,0,0,6,0,0},
	  {0,6,0,0,0,3,0,0,2}
	},{
	  {0,0,7,2,5,6,4,0,0},
	  {4,0,0,0,0,0,0,0,5},
	  {0,1,0,0,3,0,0,6,0},
	  {0,0,0,5,0,8,0,0,0},
	  {0,0,8,0,6,0,2,0,0},
	  {0,0,0,1,0,7,0,0,0},
	  {0,3,0,0,7,0,0,9,0},
	  {2,0,0,0,0,0,0,0,4},
	  {0,0,6,3,1,2,7,0,0}
	},{
	  {0,0,0,0,0,0,0,0,0},
	  {0,7,9,0,5,0,1,8,0},
	  {8,0,0,0,0,0,0,0,7},
	  {0,0,7,3,0,6,8,0,0},
	  {4,5,0,7,0,8,0,9,6},
	  {0,0,3,5,0,2,7,0,0},
	  {7,0,0,0,0,0,0,0,5},
	  {0,1,6,0,3,0,4,2,0},
	  {0,0,0,0,0,0,0,0,0}
	},{
	  {0,3,0,0,0,0,0,8,0},
	  {0,0,9,0,0,0,5,0,0},
	  {0,0,7,5,0,9,2,0,0},
	  {7,0,0,1,0,5,0,0,8},
	  {0,2,0,0,9,0,0,3,0},
	  {9,0,0,4,0,2,0,0,1},
	  {0,0,4,2,0,7,1,0,0},
	  {0,0,2,0,0,0,8,0,0},
	  {0,7,0,0,0,0,0,9,0}
	},{
	  {2,0,0,1,7,0,6,0,3},
	  {0,5,0,0,0,0,1,0,0},
	  {0,0,0,0,0,6,0,7,9},
	  {0,0,0,0,4,0,7,0,0},
	  {0,0,0,8,0,1,0,0,0},
	  {0,0,9,0,5,0,0,0,0},
	  {3,1,0,4,0,0,0,0,0},
	  {0,0,5,0,0,0,0,6,0},
	  {9,0,6,0,3,7,0,0,2}
	},{
	  {0,0,0,0,0,0,0,8,0},
	  {8,0,0,7,0,1,0,4,0},
	  {0,4,0,0,2,0,0,3,0},
	  {3,7,4,0,0,0,9,0,0},
	  {0,0,0,0,3,0,0,0,0},
	  {0,0,5,0,0,0,3,2,1},
	  {0,1,0,0,6,0,0,5,0},
	  {0,5,0,8,0,2,0,0,6},
	  {0,8,0,0,0,0,0,0,0}
	},{
	  {0,0,0,0,0,0,0,8,5},
	  {0,0,0,2,1,0,0,0,9},
	  {9,6,0,0,8,0,1,0,0},
	  {5,0,0,8,0,0,0,1,6},
	  {0,0,0,0,0,0,0,0,0},
	  {8,9,0,0,0,6,0,0,7},
	  {0,0,9,0,7,0,0,5,2},
	  {3,0,0,0,5,4,0,0,0},
	  {4,8,0,0,0,0,0,0,0}
	},{
	  {6,0,8,0,7,0,5,0,2},
	  {0,5,0,6,0,8,0,7,0},
	  {0,0,2,0,0,0,3,0,0},
	  {5,0,0,0,9,0,0,0,6},
	  {0,4,0,3,0,2,0,5,0},
	  {8,0,0,0,5,0,0,0,3},
	  {0,0,5,0,0,0,2,0,0},
	  {0,1,0,7,0,4,0,9,0},
	  {4,0,9,0,6,0,7,0,1}
	},{
	  {0,5,0,0,1,0,0,4,0},
	  {1,0,7,0,0,0,6,0,2},
	  {0,0,0,9,0,5,0,0,0},
	  {2,0,8,0,3,0,5,0,1},
	  {0,4,0,0,7,0,0,2,0},
	  {9,0,1,0,8,0,4,0,6},
	  {0,0,0,4,0,1,0,0,0},
	  {3,0,4,0,0,0,7,0,9},
	  {0,2,0,0,6,0,0,1,0}
	},{
	  {0,5,3,0,0,0,7,9,0},
	  {0,0,9,7,5,3,4,0,0},
	  {1,0,0,0,0,0,0,0,2},
	  {0,9,0,0,8,0,0,1,0},
	  {0,0,0,9,0,7,0,0,0},
	  {0,8,0,0,3,0,0,7,0},
	  {5,0,0,0,0,0,0,0,3},
	  {0,0,7,6,4,1,2,0,0},
	  {0,6,1,0,0,0,9,4,0}
	},{
	  {0,0,6,0,8,0,3,0,0},
	  {0,4,9,0,7,0,2,5,0},
	  {0,0,0,4,0,5,0,0,0},
	  {6,0,0,3,1,7,0,0,4},
	  {0,0,7,0,0,0,8,0,0},
	  {1,0,0,8,2,6,0,0,9},
	  {0,0,0,7,0,2,0,0,0},
	  {0,7,5,0,4,0,1,9,0},
	  {0,0,3,0,9,0,6,0,0}
	},{
	  {0,0,5,0,8,0,7,0,0},
	  {7,0,0,2,0,4,0,0,5},
	  {3,2,0,0,0,0,0,8,4},
	  {0,6,0,1,0,5,0,4,0},
	  {0,0,8,0,0,0,5,0,0},
	  {0,7,0,8,0,3,0,1,0},
	  {4,5,0,0,0,0,0,9,1},
	  {6,0,0,5,0,8,0,0,7},
	  {0,0,3,0,1,0,6,0,0}
	},{
	  {0,0,0,9,0,0,8,0,0},
	  {1,2,8,0,0,6,4,0,0},
	  {0,7,0,8,0,0,0,6,0},
	  {8,0,0,4,3,0,0,0,7},
	  {5,0,0,0,0,0,0,0,9},
	  {6,0,0,0,7,9,0,0,8},
	  {0,9,0,0,0,4,0,1,0},
	  {0,0,3,6,0,0,2,8,4},
	  {0,0,1,0,0,7,0,0,0}
	},{
	  {0,0,0,0,8,0,0,0,0},
	  {2,7,0,0,0,0,0,5,4},
	  {0,9,5,0,0,0,8,1,0},
	  {0,0,9,8,0,6,4,0,0},
	  {0,2,0,4,0,3,0,6,0},
	  {0,0,6,9,0,5,1,0,0},
	  {0,1,7,0,0,0,6,2,0},
	  {4,6,0,0,0,0,0,3,8},
	  {0,0,0,0,9,0,0,0,0}
	},{
	  {0,0,0,6,0,2,0,0,0},
	  {4,0,0,0,5,0,0,0,1},
	  {0,8,5,0,1,0,6,2,0},
	  {0,3,8,2,0,6,7,1,0},
	  {0,0,0,0,0,0,0,0,0},
	  {0,1,9,4,0,7,3,5,0},
	  {0,2,6,0,4,0,5,3,0},
	  {9,0,0,0,2,0,0,0,7},
	  {0,0,0,8,0,9,0,0,0}
	},{
	  {0,0,0,9,0,0,0,0,2},
	  {0,5,0,1,2,3,4,0,0},
	  {0,3,0,0,0,0,1,6,0},
	  {9,0,8,0,0,0,0,0,0},
	  {0,7,0,0,0,0,0,9,0},
	  {0,0,0,0,0,0,2,0,5},
	  {0,9,1,0,0,0,0,5,0},
	  {0,0,7,4,3,9,0,2,0},
	  {4,0,0,0,0,7,0,0,0}
	},{
	  {3,8,0,0,0,0,0,0,0},
	  {0,0,0,4,0,0,7,8,5},
	  {0,0,9,0,2,0,3,0,0},
	  {0,6,0,0,9,0,0,0,0},
	  {8,0,0,3,0,2,0,0,9},
	  {0,0,0,0,4,0,0,7,0},
	  {0,0,1,0,7,0,5,0,0},
	  {4,9,5,0,0,6,0,0,0},
	  {0,0,0,0,0,0,0,9,2}
	},{
	  {0,0,0,1,5,8,0,0,0},
	  {0,0,2,0,6,0,8,0,0},
	  {0,3,0,0,0,0,0,4,0},
	  {0,2,7,0,3,0,5,1,0},
	  {0,0,0,0,0,0,0,0,0},
	  {0,4,6,0,8,0,7,9,0},
	  {0,5,0,0,0,0,0,8,0},
	  {0,0,4,0,7,0,1,0,0},
	  {0,0,0,3,2,5,0,0,0}
	},{
	  {0,1,0,5,0,0,2,0,0},
	  {9,0,0,0,0,1,0,0,0},
	  {0,0,2,0,0,8,0,3,0},
	  {5,0,0,0,3,0,0,0,7},
	  {0,0,8,0,0,0,5,0,0},
	  {6,0,0,0,8,0,0,0,4},
	  {0,4,0,1,0,0,7,0,0},
	  {0,0,0,7,0,0,0,0,6},
	  {0,0,3,0,0,4,0,5,0}
	},{
	  {0,8,0,0,0,0,0,4,0},
	  {0,0,0,4,6,9,0,0,0},
	  {4,0,0,0,0,0,0,0,7},
	  {0,0,5,9,0,4,6,0,0},
	  {0,7,0,6,0,8,0,3,0},
	  {0,0,8,5,0,2,1,0,0},
	  {9,0,0,0,0,0,0,0,5},
	  {0,0,0,7,8,1,0,0,0},
	  {0,6,0,0,0,0,0,1,0}
	},{
	  {9,0,4,2,0,0,0,0,7},
	  {0,1,0,0,0,0,0,0,0},
	  {0,0,0,7,0,6,5,0,0},
	  {0,0,0,8,0,0,0,9,0},
	  {0,2,0,9,0,4,0,6,0},
	  {0,4,0,0,0,2,0,0,0},
	  {0,0,1,6,0,7,0,0,0},
	  {0,0,0,0,0,0,0,3,0},
	  {3,0,0,0,0,5,7,0,2}
	},{
	  {0,0,0,7,0,0,8,0,0},
	  {0,0,6,0,0,0,0,3,1},
	  {0,4,0,0,0,2,0,0,0},
	  {0,2,4,0,7,0,0,0,0},
	  {0,1,0,0,3,0,0,8,0},
	  {0,0,0,0,6,0,2,9,0},
	  {0,0,0,8,0,0,0,7,0},
	  {8,6,0,0,0,0,5,0,0},
	  {0,0,2,0,0,6,0,0,0}
	},{
	  {0,0,1,0,0,7,0,9,0},
	  {5,9,0,0,8,0,0,0,1},
	  {0,3,0,0,0,0,0,8,0},
	  {0,0,0,0,0,5,8,0,0},
	  {0,5,0,0,6,0,0,2,0},
	  {0,0,4,1,0,0,0,0,0},
	  {0,8,0,0,0,0,0,3,0},
	  {1,0,0,0,2,0,0,7,9},
	  {0,2,0,7,0,0,4,0,0}
	},{
	  {0,0,0,0,0,3,0,1,7},
	  {0,1,5,0,0,9,0,0,8},
	  {0,6,0,0,0,0,0,0,0},
	  {1,0,0,0,0,7,0,0,0},
	  {0,0,9,0,0,0,2,0,0},
	  {0,0,0,5,0,0,0,0,4},
	  {0,0,0,0,0,0,0,2,0},
	  {5,0,0,6,0,0,3,4,0},
	  {3,4,0,2,0,0,0,0,0}
	},{
	  {3,0,0,2,0,0,0,0,0},
	  {0,0,0,1,0,7,0,0,0},
	  {7,0,6,0,3,0,5,0,0},
	  {0,7,0,0,0,9,0,8,0},
	  {9,0,0,0,2,0,0,0,4},
	  {0,1,0,8,0,0,0,5,0},
	  {0,0,9,0,4,0,3,0,1},
	  {0,0,0,7,0,2,0,0,0},
	  {0,0,0,0,0,8,0,0,6}
	}
};

void print_puzzle(char (*a)[9], int l, int c)
{
	int i, j;

	for (i = 0; i < l; i++){
		for (j = 0; j < c; j++)
			printf("%d ", a[i][j]);
		printf("\n");
	}
}

int is_valid(char number, char (*puzzle)[9], int row, int column)
{
	int i = 0;
	int sector_row = 3 * (row / 3);
	int sector_col = 3 * (column / 3);
	int row1 = (row + 2) % 3;
	int row2 = (row + 4) % 3;
	int col1 = (column + 2) % 3;
	int col2 = (column + 4) % 3;

	while (i < 9){
		if (puzzle[i][column] == number) return 0;
		if (puzzle[row][i] == number) return 0;
		i++;
	}

	if (puzzle[row1 + sector_row][col1 + sector_col] == number) return 0;
	if (puzzle[row2 + sector_row][col1 + sector_col] == number) return 0;
	if (puzzle[row1 + sector_row][col2 + sector_col] == number) return 0;
	if (puzzle[row2 + sector_row][col2 + sector_col] == number) return 0;

	return 1;
}

int sudoku(char (*puzzle)[9], int row, int column)
{
	int nextn = 1;

	if (row == 9)
		return 1;

	if (puzzle[row][column]) {
		if (column == 8) {
			if (sudoku(puzzle, row + 1, 0)) return 1;
		} else {
			if (sudoku(puzzle, row, column + 1)) return 1;
		}
		return 0;
	}

	for( ; nextn < 10; nextn++) {
		if (is_valid(nextn, puzzle, row, column)) {
			puzzle[row][column] = nextn;
			if (column == 8) {
				if (sudoku(puzzle, row + 1, 0)) return 1;
			} else {
				if (sudoku(puzzle, row, column + 1)) return 1;
			}
			puzzle[row][column] = 0;
		}
	}

	return 0;
}

void dispatcher(void){
	int32_t i, j;
	char buf[9][9];
	int16_t val;
	uint16_t cpu, port, size;
	int8_t status[50];
	int8_t cpus[50];
	int8_t next = 0, received = 0;
	int8_t temp;
	uint32_t t;
	char** tasks[50];

	for(i=0;i<50;i++){
		tasks[i] = p[i];
	}

	if (hf_comm_create(hf_selfid(), 100, 0))
		panic(0xff);

	srand(hf_cpuid());

	for (i = 0; i < sizeof(status); i++)
		status[i] = cpus[i] = 0;


	print_puzzle(tasks[0], 9, 9);

	t = _readcounter();
	printf("[DISPATCHER]:: Tempo Inicial %d\n", t);
	while (1){
		 i = hf_recvprobe();
		 if (i >= 0) {
		 	size = 0;
		 	val = hf_recv(&cpu, &port, buf, &size, i);
			if (val)
				printf("hf_recv(): error %d\n", val);
			printf("[DISPATCHER]:: Recebe de %d na porta %d\n", cpu, port);

			if (size == 10){
				printf("[DISPATCHER]:: Envia problema para %d na porta %d\n", cpu, port);
				if(next < 50){
					printf("[DISPATCHER]: Indo enviar problema para %d na porta %d\n", cpu, port);
					printf("[DISPATCHER]: Mais info: %d\n", next);
					cpus[cpu] = next;
					status[next] = 1;
					val = hf_send(cpu, 3000, tasks[next], 81, hf_cpuid());
					if (val)
						printf("hf_send(): error %d\n", val);
					next++;
				}else{
					printf("[DISPATCHER]: Avisa nenhum problema disponível para %d na porta %d\n", cpu, port);
					val = hf_send(cpu, 3000, buf, 20, hf_cpuid());
					if (val)
						printf("hf_sendack(): error %d\n", val);
				}
			} else {
				printf("[DISPATCHER]:: Recebeu resultado de %d na porta %d\n", cpu, port);
				temp = cpus[cpu];
				status[temp] = 2;
				tasks[temp] = *buf;

				printf("[DISPATCHER]::  Recebe resultado de %d\n", cpu);

				print_puzzle(buf, 9, 9);

				received++;
				printf("[DISPATCHER]:: Recebido %d resultados\n", received);
				if (received >= 50){
					t = _readcounter() - t;
					printf("[DISPATCHER]:: Tempo de Processamento Total: %d\n", t);
				}
			}
		}
	}
}

void worker(void){
	int32_t i,j;
	char buf[9][9];
	int8_t waiting;
	int16_t val, channel;
	uint16_t cpu, port, size;

	if (hf_comm_create(hf_selfid(), 3000, 0))
		panic(0xff);

	delay_ms(10*hf_cpuid());

	srand(hf_cpuid());

	channel = hf_cpuid();
	waiting = 0;
	while (1){
		if (!waiting){
			val = hf_send(0, 100, buf, 10, channel);
			if (val)
				printf("hf_sendack(): error %d\n", val);
			else
				printf("[WORKER %d]:: Pede novo problema \n", channel);
			waiting = 1;
		}

		i = hf_recvprobe();
		if (i >= 0) {
			printf("[WORKER]:: i = %d \n ", i);
			size = 0;
			val = hf_recv(&cpu, &port, buf, &size, i);
			if (val)
				printf("hf_recv(): error %d\n", val);
			printf("[WORKER %d]:: Recebe de %d na porta %d - size %d\n", channel, cpu, port, size);
			if (size == 20){
				printf("[WORKER %d]:: Nenhum problema disponivel\n",channel);
				delay_ms(1000);
			} else {
				printf("[WORKER %d]:: Resolve Puzzle\n", channel);

				print_puzzle(buf, 9, 9);

				sudoku(buf ,0,0);

				val = hf_send(0, 100, buf, size, channel);
				if (val)
					printf("hf_sendack(): error %d\n", val);
			}
			waiting = 0;
		}
	}
}

void app_main(void)
{
	if (hf_cpuid() == 0){
		hf_spawn(dispatcher, 0, 0, 0, "t0", 4096);
	}else{
//		hf_spawn(worker, 0, 0, 0, "t"+hf_cpuid(), 4096);
		hf_spawn(worker, 0, 0, 0, "t800", 8192);
	}
}